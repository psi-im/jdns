This code is taken from the Firefox Android support source code:
http://dxr.mozilla.org/mozilla-central/source/other-licenses/android